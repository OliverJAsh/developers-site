"format cjs";function parse(e){return parseInheritance(parseConditionals(e))}function parseInheritance(e){return e.replace(/^ *(\w+)\.prototype\.__proto__ * = *(\w+)\.prototype *;?/gm,function(e,r,n){return r+".prototype = new "+n+";\n"+r+".prototype.constructor = "+r+";\n"})}function parseConditionals(e){for(var r,n,t=e.split("\n"),i=t.length,s=!0,o=!1,u=[],a=0;i>a;++a)r=t[a],/^ *\/\/ *if *(node|browser)/gm.exec(r)?(n=RegExp.$1,s=o="browser"==n):/^ *\/\/ *end/.test(r)?(s=!0,o=!1):o?u.push(r.replace(/^( *)\/\//,"$1")):s&&u.push(r);return u.join("\n")}function compile(){var e="";e+="ejs = (function(){\n",e+="\n// CommonJS require()\n\n",e+=browser.require+"\n\n",e+="require.modules = {};\n\n",e+="require.resolve = "+browser.resolve+";\n\n",e+="require.register = "+browser.register+";\n\n",e+="require.relative = "+browser.relative+";\n\n",args.forEach(function(r){var n=files[r];r=r.replace("lib/",""),e+='\nrequire.register("'+r+'", function(module, exports, require){\n',e+=n,e+="\n}); // module: "+r+"\n"}),e+='\n return require("ejs");\n})();',fs.writeFile("ejs.js",e,function(e){if(e)throw e;console.log("  [90m create : [0m[36m%s[0m","ejs.js"),console.log()})}var fs=require("github:jspm/nodelibs@0.0.2/fs"),args=process.argv.slice(2),pending=args.length,files={};console.log(""),args.forEach(function(e){e.replace("lib/","");fs.readFile(e,"utf8",function(r,n){if(r)throw r;console.log("  [90mcompile : [0m[36m%s[0m",e),files[e]=parse(n),--pending||compile()})});var browser={require:function require(e){if("fs"==e)return{};if("path"==e)return{};var r=require.resolve(e),n=require.modules[r];if(!n)throw new Error('failed to require "'+e+'"');return n.exports||(n.exports={},n.call(n.exports,n,n.exports,require.relative(r))),n.exports},resolve:function(e){var r=e,n=e+".js",t=e+"/index.js";return require.modules[n]&&n||require.modules[t]&&t||r},relative:function(e){return function(r){if("."!=r.substr(0,1))return require(r);var n=e.split("/"),t=r.split("/");n.pop();for(var i=0;i<t.length;i++){var s=t[i];".."==s?n.pop():"."!=s&&n.push(s)}return require(n.join("/"))}},register:function(e,r){require.modules[e]=r}};
//# sourceMappingURL=compile.js.map