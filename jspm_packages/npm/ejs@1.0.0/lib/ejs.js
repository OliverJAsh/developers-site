/* */
"format cjs";function filtered(e){return e.substr(1).split("|").reduce(function(e,r){var n=r.split(":"),t=n.shift(),i=n.join(":")||"";return i&&(i=", "+i),"filters."+t+"("+e+i+")"})}function rethrow(e,r,n,t){var i=r.split("\n"),s=Math.max(t-3,0),o=Math.min(i.length,t+3),a=i.slice(s,o).map(function(e,r){var n=r+s+1;return(n==t?" >> ":"    ")+n+"| "+e}).join("\n");throw e.path=n,e.message=(n||"ejs")+":"+t+"\n"+a+"\n\n"+e.message,e}function resolveInclude(e,r){var n=join(dirname(r),e),t=extname(e);return t||(n+=".ejs"),n}var utils=require("./utils"),path=require("github:jspm/nodelibs@0.0.3/path"),dirname=path.dirname,extname=path.extname,join=path.join,fs=require("github:jspm/nodelibs@0.0.3/fs"),read=fs.readFileSync,filters=exports.filters=require("./filters"),cache={};exports.clearCache=function(){cache={}};var parse=exports.parse=function(e,r){var r=r||{},n=r.open||exports.open||"<%",t=r.close||exports.close||"%>",i=r.filename,s=r.compileDebug!==!1,o="";o+="var buf = [];",!1!==r._with&&(o+="\nwith (locals || {}) { (function(){ "),o+="\n buf.push('";for(var a=1,u=!1,c=0,l=e.length;l>c;++c){var f=e[c];if(e.slice(c,n.length+c)==n){c+=n.length;var p,m,g=(s?"__stack.lineno=":"")+a;switch(e[c]){case"=":p="', escape(("+g+", ",m=")), '",++c;break;case"-":p="', ("+g+", ",m="), '",++c;break;default:p="');"+g+";",m="; buf.push('"}var h=e.indexOf(t,c);if(0>h)throw new Error('Could not find matching close tag "'+t+'".');var d=e.substring(c,h),v=c,j=null,b=0;if("-"==d[d.length-1]&&(d=d.substring(0,d.length-2),u=!0),0==d.trim().indexOf("include")){var x=d.trim().slice(7).trim();if(!i)throw new Error("filename option is required for includes");var _=resolveInclude(x,i);j=read(_,"utf8"),j=exports.parse(j,{filename:_,_with:!1,open:n,close:t,compileDebug:s}),o+="' + (function(){"+j+"})() + '",d=""}for(;~(b=d.indexOf("\n",b));)b++,a++;":"==d.substr(0,1)&&(d=filtered(d)),d&&(d.lastIndexOf("//")>d.lastIndexOf("\n")&&(d+="\n"),o+=p,o+=d,o+=m),c+=h-v+t.length-1}else"\\"==f?o+="\\\\":"'"==f?o+="\\'":"\r"==f||("\n"==f?u?u=!1:(o+="\\n",a++):o+=f)}return o+=!1!==r._with?"'); })();\n} \nreturn buf.join('');":"');\nreturn buf.join('');"},compile=exports.compile=function(e,r){r=r||{};var n=r.escape||utils.escape,t=JSON.stringify(e),i=r.compileDebug!==!1,s=r.client,o=r.filename?JSON.stringify(r.filename):"undefined";e=i?["var __stack = { lineno: 1, input: "+t+", filename: "+o+" };",rethrow.toString(),"try {",exports.parse(e,r),"} catch (err) {","  rethrow(err, __stack.input, __stack.filename, __stack.lineno);","}"].join("\n"):exports.parse(e,r),r.debug&&console.log(e),s&&(e="escape = escape || "+n.toString()+";\n"+e);try{var a=new Function("locals, filters, escape, rethrow",e)}catch(u){throw"SyntaxError"==u.name&&(u.message+=r.filename?" in "+o:" while compiling ejs"),u}return s?a:function(e){return a.call(this,e,filters,n,rethrow)}};exports.render=function(e,r){var n,r=r||{};if(r.cache){if(!r.filename)throw new Error('"cache" option requires "filename".');n=cache[r.filename]||(cache[r.filename]=compile(e,r))}else n=compile(e,r);return r.__proto__=r.locals,n.call(r.scope,r)},exports.renderFile=function(e,r,n){var t=e+":string";"function"==typeof r&&(n=r,r={}),r.filename=e;var i;try{i=r.cache?cache[t]||(cache[t]=read(e,"utf8")):read(e,"utf8")}catch(s){return void n(s)}n(null,exports.render(i,r))},exports.__express=exports.renderFile,require.extensions?require.extensions[".ejs"]=function(e,r){r=r||e.filename;var n={filename:r,client:!0},t=fs.readFileSync(r).toString(),i=compile(t,n);e._compile("module.exports = "+i.toString()+";",r)}:require.registerExtension&&require.registerExtension(".ejs",function(e){return compile(e,{})});
//# sourceMappingURL=ejs.js.map